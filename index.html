<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<link rel="alternate" href="/default" title="Hexo"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="http://yoursite.com/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true,"latex":false};
</script>

    <title>Hexo</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Hexo</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/about">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Hexo</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2018-8-15-build-your-own-php-framework-in-30min/">30分钟，从0构建自己的PHP框架</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="composer-一切的基础"><a href="#composer-一切的基础" class="headerlink" title="composer 一切的基础"></a>composer 一切的基础</h2><ul>
<li><code>composer</code> 是什么? 在 <code>python</code> 语言中它叫 <code>pip</code> 在 <code>javascript</code> 中它叫 <code>npm</code>, 用于安装和管理第三方库</li>
<li>安装 <code>composer</code> <a href="http://getcomposer.org" title="composer" target="_blank" rel="noopener">http://getcomposer.org</a></li>
<li>初始项目 <code>composer init</code> </li>
<li>创建基础类  <code>Application.php</code></li>
<li>使用 <code>composer psr-4</code> 加载基础类</li>
</ul>
<h2 id="异常的处理-踏出坚实的第一步"><a href="#异常的处理-踏出坚实的第一步" class="headerlink" title="异常的处理 - 踏出坚实的第一步"></a>异常的处理 - 踏出坚实的第一步</h2><ul>
<li><p>安装 <code>symfony/debug</code> 引入基础的异常类</p>
</li>
<li><p>注册异常处理函数 (<code>set_error_handler</code>,<code>set_exception_handler</code>,<code>register_shutdown_function</code>)</p>
</li>
<li><p>异常的处理 (渲染输出,记录日志，邮件上报)</p>
</li>
<li><p>什么时候注册异常处理函数呢？ Laravel 是在 Handle http 请求的时候，注册 <code>HandleExceptions</code></p>
</li>
<li><p>直接抄袭 <code>Laravel</code> 即可<a href="https://github.com/laravel/framework/blob/7212b1e9620c36bf806e444f6931cf5f379c68ff/src/Illuminate/Foundation/Bootstrap/HandleExceptions.php#L28" target="_blank" rel="noopener"> 代码位于 <code>Illuminate/Foundation/Bootstrap/HandleExceptions.php</code></a></p>
</li>
<li><p>laravel 的异常处理，还依赖<code>illuminate/http</code> 同样也安装一下</p>
</li>
<li><p>在 <code>Application</code> 中执行异常处理</p>
</li>
</ul>
<h2 id="IOC-框架的灵魂"><a href="#IOC-框架的灵魂" class="headerlink" title="IOC - 框架的灵魂"></a>IOC - 框架的灵魂</h2><ul>
<li>IOC 容器是什么?一个配置中心,一个数组</li>
<li>什么叫依赖注入? 从配置中心找到你需要的那一个实例</li>
<li>Laravel 容器的介绍 <a href="https://gist.github.com/davejamesmiller/bd857d9b0ac895df7604dd2e63b23afe" title="IOC" target="_blank" rel="noopener">https://gist.github.com/davejamesmiller/bd857d9b0ac895df7604dd2e63b23afe</a></li>
<li>看一个简单的例子</li>
<li>安装 容器 <code>illuminate/container</code></li>
<li>后面会介绍容器使用的典型的例子</li>
</ul>
<h2 id="MVC架构的实现-从路由开始"><a href="#MVC架构的实现-从路由开始" class="headerlink" title="MVC架构的实现 - 从路由开始"></a><code>MVC</code>架构的实现 - 从路由开始</h2><ul>
<li>fastroute 介绍 <a href="http://nikic.github.io/2014/02/18/Fast-request-routing-using-regular-expressions.html" title="fastroute" target="_blank" rel="noopener">http://nikic.github.io/2014/02/18/Fast-request-routing-using-regular-expressions.html</a></li>
<li>安装 fastroute <code>composer require nikic/fast-route</code>、</li>
<li>在入库初始化 fastroute</li>
<li>如何使用控制器而不是闭包?</li>
</ul>
<h2 id="模板引擎-从外到里的美"><a href="#模板引擎-从外到里的美" class="headerlink" title="模板引擎 - 从外到里的美"></a>模板引擎 - 从外到里的美</h2><ul>
<li>控制器有了，我们来输出页面</li>
<li>twig <a href="https://twig.symfony.com/" title="twig" target="_blank" rel="noopener">https://twig.symfony.com/</a></li>
<li>安装 <code>twig/twig</code></li>
<li>使用 IOC 容器，加载视图</li>
</ul>
<h2 id="配置文件的加载-扩展只为未来"><a href="#配置文件的加载-扩展只为未来" class="headerlink" title="配置文件的加载 - 扩展只为未来"></a>配置文件的加载 - 扩展只为未来</h2><ul>
<li><p>在进行真正的业务代码编写之前，我们需要一个配置文件</p>
</li>
<li><p>安装 dotEnv <a href="https://symfony.com/doc/current/components/dotenv.html" title="dotEnv" target="_blank" rel="noopener">https://symfony.com/doc/current/components/dotenv.html</a></p>
</li>
<li><p>配置基础信息 <code>环境和数据库</code></p>
</li>
</ul>
<h2 id="orm-最受争议的存在"><a href="#orm-最受争议的存在" class="headerlink" title="orm 最受争议的存在"></a>orm 最受争议的存在</h2><ul>
<li>一个特别简单的<code>ORM</code></li>
<li>redbean <a href="https://github.com/gabordemooij/redbean" title="redbean" target="_blank" rel="noopener">https://github.com/gabordemooij/redbean</a></li>
<li>安装 <code>gabordemooij/redbean</code></li>
<li>配置 ，此时就用到了我们的配置文件了</li>
<li>运行我们的 Hello world </li>
</ul>
<h2 id="命令行-geek的工具箱"><a href="#命令行-geek的工具箱" class="headerlink" title="命令行 - geek的工具箱"></a>命令行 - geek的工具箱</h2><ul>
<li><a href="https://symfony.com/doc/current/components/console.html" title="console" target="_blank" rel="noopener">https://symfony.com/doc/current/components/console.html</a></li>
<li>安装 <code>symfony/console</code></li>
<li>演示 hello world</li>
</ul>
<h2 id="完工了-也许仅仅只是开始！"><a href="#完工了-也许仅仅只是开始！" class="headerlink" title="完工了?? 也许仅仅只是开始！"></a>完工了?? 也许仅仅只是开始！</h2><ul>
<li>日志</li>
<li>验证器 validate</li>
<li>http 中间件</li>
<li>session 支持</li>
<li>小项目最终都变成了大项目。</li>
</ul>
<h2 id="感谢大家！"><a href="#感谢大家！" class="headerlink" title="感谢大家！"></a>感谢大家！</h2>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2017-11-07-the-end-of-web-tech/">web技术的尽头</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="web技术的尽头"><a href="#web技术的尽头" class="headerlink" title="web技术的尽头"></a>web技术的尽头</h2><blockquote>
<p>文章写于2016年国庆期间, 也是偶然间从笔记中找到,回头再看,感慨颇多.</p>
</blockquote>
<p>刚刚学习网站开发的时候，用简单的html就做了一个网站，兴奋的不得了。后来慢慢明天每一个技术一旦深入下去都有很大的潜力，可以玩出很多花样来。</p>
<p>这些年，学了太多杂七杂八的技术，ps切图 html css jquery wordpress php mysql  joomla 然后是 thinkphp 再后来是 laravel 现在做 b2b2c的开发。</p>
<p>想起来还真没有学到什么有技术含量的东西，也从未解决过真正的大数据和高并发问题。只是不停的修改页面，做一些业务功能的增删查改。</p>
<h2 id="对于前端"><a href="#对于前端" class="headerlink" title="对于前端"></a>对于前端</h2><blockquote>
<p>无非是切图做一个html骨架，写css样式，然后找找网上的Jquery插件。然而这每一个东西都是可以深入去学习的</p>
</blockquote>
<h3 id="比如css"><a href="#比如css" class="headerlink" title="比如css"></a>比如css</h3><ul>
<li>样式重设： reset.css 比如normalize.css </li>
<li>字体：frontawesome</li>
<li>预编译工具 ：sacss less </li>
<li>构建工具：gulp webpack等等</li>
<li>UI 框架： bootstrap amazeui sui 等等</li>
<li>针对移动端 还有 css3 flex-box css grid 媒体查询 等等新的技术</li>
<li>性能的优化：文件压缩合并 md5版本号，cdn, appcache </li>
</ul>
<h3 id="比如javascript"><a href="#比如javascript" class="headerlink" title="比如javascript"></a>比如javascript</h3><ul>
<li>新的规范：ecmas 2015 | 2016</li>
<li>加载器 ： cmd amd require.js import sea.js</li>
<li>服务端：node.js koa express 内容特别多。涵盖整个服务端生态了。</li>
<li>包管理器：npm borwer 等等。</li>
<li>构建工具：gulp webpack等等</li>
<li>异步：await sync ，promise </li>
<li>dom 框架 zepto.js jquery.js</li>
<li>基础类库：loaddash iscroll fastclick等等</li>
<li>mvvm框架：react vue angular 等等</li>
<li>混合开发工具：react-native apicloud 微信小程序 ironic</li>
</ul>
<p>##对于后端</p>
<blockquote>
<p>后端似乎没有什么颠覆性的东西</p>
</blockquote>
<ul>
<li>新的编译器 php7</li>
<li>包管理器 phar composer</li>
<li>新的框架 laravel </li>
</ul>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><p>这几年涌现了很多的新技术，给人一种感觉，技术淘汰的越来越快。然而我却发现，新技术的火热更多的是体现在前端的技术上面，尤其是javascript上面。</p>
<p>似乎并没有人愿意在服务端上制造什么轮子，虽然服务端也涌现了很多的新名词，比如 golang docker 微服务 大数据（hadoop,spark）但是这些对后端开发影响甚微。</p>
<p>新的编程语言，后端人员视乎不愿意尝试，比如golang 比如 openresty 。可能90%的网站并没有对性能要求苛刻到这样的程度，只有极少数人能有机会接触到并使用到这些技术，大多数普通服务端程序员仅仅只是做业务逻辑的增删查改。简单的看看各个web框架，所有的功能无非就是那些。</p>
<h3 id="一般所说的服务端开发"><a href="#一般所说的服务端开发" class="headerlink" title="一般所说的服务端开发"></a>一般所说的服务端开发</h3><ul>
<li>会员认证：session jwt token oauth sso</li>
<li>路由 ： 简单的路由类似 tp和yii 按照方法名来，复杂的路由类似laravel</li>
<li>模型：无非就是ActiveRecord Doctrine 的orm 加上一个查询构造器</li>
<li>视图：以前是smarty 或者不用模板引擎 或者用php作为模板引擎，多数网站都提供了一个layout的功能。再现在看来视图的意义越来越小了，只是方便后端开发。</li>
<li>异常日志：无非是那些。</li>
<li>框架与设计模式：比如facade设计模式 IOC eventbus 等等。</li>
<li>第三方集成：cdn oss 直播 weixin 短信 邮件</li>
</ul>
<h4 id="高性能"><a href="#高性能" class="headerlink" title="高性能"></a>高性能</h4><ul>
<li>缓存：memcache redis 共享内存 文件缓存 等等</li>
<li>RPC ： bbc的那一套挺好的，thinkphp的Service也可以改造</li>
<li>计划任务：crontab web-cron</li>
<li>队列：redis swoole </li>
<li>消息队列 ：kafka rabitMQ 等等</li>
<li>数据库：主从分离，集群。有了云之后已经越来越不需要了。</li>
<li>搜索：sphinx 等等也只是配置即可。</li>
</ul>
<blockquote>
<p>使用消息队列的意义主要是让前端快速响应，可以将任务分配给远程的机器去运行比nginx的负载均衡定制化程度高。两者是可以配合使用。nginx 负载均衡负责web请求的应答，MQ负责把耗时任务放到另外机器运行。所做的一起都是为了分担服务器压力，提供高性能。</p>
</blockquote>
<h2 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h2><p>越来越多的公司开始完全用前端渲染页面了，意味着PHP渲染模板的优势其实已经没有了，后端的一切最终是Api化的，然而这方面往往对性能要求很高，意味着是不是前端Api 不再需要php了？答案是否定的，php的优势并不是性能，而是快速开发。大多数公司应该是先使用php做好mvp让项目跑起来，在发展的过程中，遇到了性能问题再去优化他。真正到了要更换语言才能解决性能问题的公司还是少之又少。但是技术人员应该是多多尝试，在前端Api上不重要的场景可以尝试各种语言各种框架。</p>
<p>对于一直往web方向发展的我来说，应该是要确定自己的发力方向。web技术日新月异，再广度上不停的发展。然而我必须积累些东西。作为日后求职的资本。</p>
<p>首先确定的是，不再往前端投入过多的精力。前端的技术只要会照着api使用即可了，不用过于深入。<br>其次是往前端高性能的方向专研。其实很多公司面试会不会高性能，无非就是问问会不会使用缓存使用redis这些。然而我还有个共享内存的大杀器，可以吹牛。<br>然后是往后端高性能的方向研究，后端可能就是数据库主从，服务器的集群，no-sql ，然后消息队列，搜索什么的，这些东西其实不难。也都是工具的使用。只是这些东西平时并不使用，所以生疏，其实有时间更本不是问题。</p>
<h2 id="求职之外的技术需要"><a href="#求职之外的技术需要" class="headerlink" title="求职之外的技术需要"></a>求职之外的技术需要</h2><p>对于我个人，我更想学习linux运维方面的知识，把linux搞透，目前也是我唯一的兴趣所在了。然后是大数据，云等等相关的知识，尤其想要去了解去学习。</p>
<h2 id="关于田田云，我能学到什么"><a href="#关于田田云，我能学到什么" class="headerlink" title="关于田田云，我能学到什么"></a>关于田田云，我能学到什么</h2><p>在后期会调优php的性能，学习到新的php框架，使用一种Api网关，使用一种消息队列。抽离bbc里面的扩展出来，成为自己的积累。我觉得这个特别重要。<br>看看怎么做持续集成和分布式架构</p>
<h2 id="在工作中怎么去丰满自己"><a href="#在工作中怎么去丰满自己" class="headerlink" title="在工作中怎么去丰满自己"></a>在工作中怎么去丰满自己</h2><p>技术的路子似乎越走越窄，很难深入去学习某个新的技术，反而更倾向于去集成学习一些框架和库，怎样更好的去组织代码怎样让程序有更好的扩展性和性能。即便是真的想学点什么，劳累一天之后也确实难有精力再去做点其他，如果和现在的工作又无关，那么很快就会面临放弃的境地。对于学习中的这些问题，我更倾向于在工作不忙的时候，把新的东西整合到现有的平台中。</p>
<p>目前工作的闲暇时间几乎是被微博和cnbeta等等完全占据了，放弃这些必须要找到更能吸引自己注意力的东西。我的想法是多看书，多看真正的技术文章。学习新的技巧。然而零散的学习是没用的，必须是成体系的东西，一路专研某个东西，比如linux比如容器技术或者是js的某个插件某个库。一定是真正的深入去学习，不能浮躁。</p>
<h2 id="恐惧的心态"><a href="#恐惧的心态" class="headerlink" title="恐惧的心态"></a>恐惧的心态</h2><h3 id="如何去学习目前并不会使用的工具。"><a href="#如何去学习目前并不会使用的工具。" class="headerlink" title="如何去学习目前并不会使用的工具。"></a>如何去学习目前并不会使用的工具。</h3><p>偶尔突发奇想要学js的一些东西，比如 loaddash 库，比如sacss ，然而这些东西在学完之后，可能立刻就被放弃了。一来是因为没有用的机会，二来是它只是单纯的工具。所以对于这类工具的技术，只需要停留在了解的层面就好了，了解就是在真正面临问题的时候，能想到这里可能有解决方案，所有的学习都是有用的。在学习的过程中，可以想象这些东西是不是能改善之前做过得事情，能适应什么样的场景等等。学点没多大用的东西也是一种享受了。</p>
<h3 id="做一个技术管理者"><a href="#做一个技术管理者" class="headerlink" title="做一个技术管理者"></a>做一个技术管理者</h3><ul>
<li>扣性能</li>
<li>扣架构</li>
<li>开发模式</li>
<li>文档管理</li>
<li>代码管理</li>
<li>发布流程</li>
<li>测试流程</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2017-04-24-phpstorm-meta-for-onethink/">为onethink增加phpstorm智能代码提示</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="让phpstorm支持thinkphp中的全局函数跳转"><a href="#让phpstorm支持thinkphp中的全局函数跳转" class="headerlink" title="让phpstorm支持thinkphp中的全局函数跳转"></a>让phpstorm支持thinkphp中的全局函数跳转</h2><hr>
<h3 id="如何编写phpstorm插件"><a href="#如何编写phpstorm插件" class="headerlink" title="如何编写phpstorm插件"></a>如何编写phpstorm插件</h3><ul>
<li>可以使用 <code>PHPSTORM_META</code>来进行函数参数的智能映射</li>
<li>在项目根目录建立 <code>.phpstorm.meta.php</code></li>
<li>映射非常的死板-所以需要有个脚本自动去生成</li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey2sxdzoxj20s50863zf.jpg" alt></p>
<hr>
<h3 id="生成脚本"><a href="#生成脚本" class="headerlink" title="生成脚本"></a>生成脚本</h3><p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey2ugo5sdj20ng0m30um.jpg" alt></p>
<p><a href="https://gist.github.com/yangyao/57a777a3c6f40b1324322efdf21f92dd" title="glist" target="_blank" rel="noopener">https://gist.github.com/yangyao/57a777a3c6f40b1324322efdf21f92dd</a></p>
<hr>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2017-04-24-artisan-command-for-thinkphp/">为ThinkPhp设计一个Artisan 控制台</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h1 id="为ThinkPhp设计一个Artisan-控制台"><a href="#为ThinkPhp设计一个Artisan-控制台" class="headerlink" title="为ThinkPhp设计一个Artisan 控制台"></a>为ThinkPhp设计一个Artisan 控制台</h1><hr>
<h2 id="artisan简单介绍"><a href="#artisan简单介绍" class="headerlink" title="artisan简单介绍"></a>artisan简单介绍</h2><blockquote>
<p>Artisan 是 Laravel 中自带的命令行工具的名称。它提供了一些对应用开发有帮助的命令。它基于 Symfony Console 组件驱动的。</p>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey04u98yoj20oo0fkdgz.jpg" alt></p>
<hr>
<h2 id="首先需要有个命令的注册中心"><a href="#首先需要有个命令的注册中心" class="headerlink" title="首先需要有个命令的注册中心"></a>首先需要有个命令的注册中心</h2><ul>
<li>建立Routes目录</li>
<li>为命令配置相应的别名</li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey0b7jmh3j20zr0bq3zm.jpg" alt></p>
<hr>
<h2 id="核心的代码实现"><a href="#核心的代码实现" class="headerlink" title="核心的代码实现"></a>核心的代码实现</h2><p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey0gfysr4j20ko0lfac0.jpg" alt></p>
<hr>
<h2 id="使用效果"><a href="#使用效果" class="headerlink" title="使用效果"></a>使用效果</h2><ul>
<li><code>php cli.php console/help</code></li>
<li><code>php cli.php Console/crontab:list dresslink.com</code></li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey0po4238j20oo0fk3z3.jpg" alt></p>
<hr>
<h2 id="简化命令的使用"><a href="#简化命令的使用" class="headerlink" title="简化命令的使用"></a>简化命令的使用</h2><ul>
<li><code>php artisan help</code></li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey1ntohshj20if0fo3zd.jpg" alt></p>
<hr>
<h1 id="使用山寨版的Artisan为Thinkphp增加计划任务管理功能"><a href="#使用山寨版的Artisan为Thinkphp增加计划任务管理功能" class="headerlink" title="使用山寨版的Artisan为Thinkphp增加计划任务管理功能"></a>使用山寨版的Artisan为Thinkphp增加计划任务管理功能</h1><hr>
<h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><ul>
<li>每个模块都可以配置计划任务</li>
<li>使用xml定义计划任务，在模块下面建立<code>crontab.xml</code></li>
<li>将xml中的计划任务dump到数据库中</li>
<li>可以在后台界面配置计划任务的执行时间</li>
<li>可以在控制台中列出所有需要执行的计划任务</li>
<li>可以再控制台中手动运行某个计划任务</li>
</ul>
<hr>
<h2 id="使用配置"><a href="#使用配置" class="headerlink" title="使用配置"></a>使用配置</h2><p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey1zz29vxj20l3098752.jpg" alt></p>
<hr>
<h2 id="实现逻辑"><a href="#实现逻辑" class="headerlink" title="实现逻辑"></a>实现逻辑</h2><p><img src="http://ww1.sinaimg.cn/large/7101c223ly1fey22dlcx5j20na0n6mz5.jpg" alt></p>
<hr>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2017-04-13-yield-and-promise/">理解yield和promise的一个过程</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h1 id="理解yield和promise的一个过程"><a href="#理解yield和promise的一个过程" class="headerlink" title="理解yield和promise的一个过程"></a>理解yield和promise的一个过程</h1><hr>
<pre><code>function sayHello(){
    return Promise.resolve(&apos;hello&apos;).then(function(hello){
        return hello;
    })
}

function *genHelloWorld(){
    var hello = yield sayHello();
    console.log(hello);
    console.log(&apos;world&apos;);
}

/**
 * 执行步骤
 * 1.sayHello                                               返回 {}
 * 2.yield sayHello()                                       返回 {value:Promise{&lt;pending&gt;},done:false}
 * 3.var hello = sayHello() &amp;&amp; console.log(hello) &amp;&amp; console.log(&apos;world&apos;) 返回 { value: &apos;undefined&apos;, done: true }
 */



// 执行了 sayHello() 等于 执行了 resolve并传递了hello过去，执行了then并传递一个回调函数
// 注意这里并没有赋值，仅仅是执行了sayHello函数，var hello 是 undefined
// 此时 gen为一个空对象 {} !!! 注意这里并没有retuan但是 gen却是一个空对象,怎么来的？
var gen = genHelloWorld()
// 此时p为一个 Promise对象 {value:Promise{&lt;pending&gt;},done:false} 
// 执行 yield {value:Promise{&lt;pending&gt;},done:false} 
// !!! 注意这里也没有return 但是 p却是一个Promise对象？怎么来的？
// 此时也没有赋值操作，var hello 是 undefined
var p = gen.next()
// 需要传递一个回调函数给 Promise 的then方法去获得返回的数据
p.value.then(function(data){
    // 获得then返回的数据之后，进行第二次迭代
    // 在异步获取到值之后再调用next走下面的流程，代码写法是同步的，但却是异步执行的
    // 此时 hello 被赋值为 data ，并且执行后面的语句直到遇到下一个yield
    // 返回 { value: undefined, done: true } !!! 注意这里也是没有return的
    console.log(gen.next(data));

})</code></pre>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2015-06-26-nginx-bug/">invalid PID number</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span></div>
    </header>

    <div class="post-content"><p>###报错信息</p>
<pre><code>nginx: [error] invalid PID number</code></pre><p>###解决方案</p>
<pre><code>sudo nginx -c /etc/nginx/nginx.conf
sudo /usr/sbin/nginx -t
sudo /usr/sbin/nginx -s reload</code></pre>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2015-06-30-windows-cmd-doskey/">windows cmd doskey</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span></div>
    </header>

    <div class="post-content"><p>###windows 下好看的cmd</p>
<pre><code>对中文显示友好，推荐`conEMU`</code></pre><p>###配置别名</p>
<pre><code>doskey ll=ls -l</code></pre>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2017-03-27-php-exception/">如何设计一个好的异常</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span><span class="post-category">
            <a href="/categories/php/">php</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h1 id="如何设计一个好用的异常"><a href="#如何设计一个好用的异常" class="headerlink" title="如何设计一个好用的异常"></a>如何设计一个好用的异常</h1><hr>
<h2 id="为什么要使用异常"><a href="#为什么要使用异常" class="headerlink" title="为什么要使用异常"></a>为什么要使用异常</h2><h3 id="明明可以使用返回值来判定一个程序的运行状况？"><a href="#明明可以使用返回值来判定一个程序的运行状况？" class="headerlink" title="明明可以使用返回值来判定一个程序的运行状况？"></a>明明可以使用返回值来判定一个程序的运行状况？</h3><blockquote>
<p>异常机制初衷就是自行触发来转移程序流程， 解决逻辑嵌套太深时错误处理的困难</p>
</blockquote>
<ul>
<li>通过返回值判断，使得语意模糊，代码混乱</li>
<li>通过返回值判断，不利于错误的集中处理</li>
<li>可以让用户有机会干预PHP的默认行为（<code>display_errors</code>和<code>error_reporting</code>）</li>
<li>在发生异常的时候能做一些log或者cleanup</li>
<li>合理的使用异常可以帮我们设计结构优良的程序</li>
<li>增加了可维护性，便于定位线上环境的bug</li>
</ul>
<hr>
<h2 id="主流的框架都是怎么处理异常的"><a href="#主流的框架都是怎么处理异常的" class="headerlink" title="主流的框架都是怎么处理异常的"></a>主流的框架都是怎么处理异常的</h2><h3 id="几乎所有框架在初始化的时候都会注册异常处理的函数，但都无非下面3个函数"><a href="#几乎所有框架在初始化的时候都会注册异常处理的函数，但都无非下面3个函数" class="headerlink" title="几乎所有框架在初始化的时候都会注册异常处理的函数，但都无非下面3个函数"></a>几乎所有框架在初始化的时候都会注册异常处理的函数，但都无非下面3个函数</h3><ul>
<li>register_shutdown_function</li>
<li>set_error_handler</li>
<li>set_exception_handler</li>
</ul>
<hr>
<h2 id="thinkphp"><a href="#thinkphp" class="headerlink" title="thinkphp"></a>thinkphp</h2><h3 id="框架初始化"><a href="#框架初始化" class="headerlink" title="框架初始化"></a>框架初始化</h3><p><a href="https://github.com/top-think/thinkphp/blob/955404d6782672b656a8d6799e87d8f47ea042ae/ThinkPHP/Library/Think/Think.class.php#L31" target="_blank" rel="noopener"> 代码位于 <code>thinkphp/ThinkPHP/Library/Think/Think.class.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdrwaxlsptj20f908jmxl" alt="thinkphp"></p>
<hr>
<h3 id="异常的处理"><a href="#异常的处理" class="headerlink" title="异常的处理"></a>异常的处理</h3><p><a href="https://github.com/top-think/thinkphp/blob/955404d6782672b656a8d6799e87d8f47ea042ae/ThinkPHP/Library/Think/Think.class.php#L241" target="_blank" rel="noopener"> 代码位于 <code>thinkphp/ThinkPHP/Library/Think/Think.class.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdrxfvi5gzj20f60eljsf" alt></p>
<hr>
<h3 id="异常的渲染与输出"><a href="#异常的渲染与输出" class="headerlink" title="异常的渲染与输出"></a>异常的渲染与输出</h3><p><a href="https://github.com/top-think/thinkphp/blob/955404d6782672b656a8d6799e87d8f47ea042ae/ThinkPHP/Library/Think/Think.class.php#L316" target="_blank" rel="noopener"> 代码位于 <code>thinkphp/ThinkPHP/Library/Think/Think.class.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdrxgxbn1mj20r70mvjt9" alt></p>
<hr>
<h2 id="laravel"><a href="#laravel" class="headerlink" title="laravel"></a>laravel</h2><h3 id="框架初始化-1"><a href="#框架初始化-1" class="headerlink" title="框架初始化"></a>框架初始化</h3><p><a href="https://github.com/laravel/framework/blob/7212b1e9620c36bf806e444f6931cf5f379c68ff/src/Illuminate/Foundation/Bootstrap/HandleExceptions.php#L28" target="_blank" rel="noopener"> 代码位于 <code>Illuminate/Foundation/Bootstrap/HandleExceptions.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdrwngimc7j20e60dpmxx" alt></p>
<hr>
<h3 id="异常的处理-1"><a href="#异常的处理-1" class="headerlink" title="异常的处理"></a>异常的处理</h3><p><a href="https://github.com/laravel/framework/blob/7212b1e9620c36bf806e444f6931cf5f379c68ff/src/Illuminate/Foundation/Bootstrap/HandleExceptions.php#L74" target="_blank" rel="noopener"> 代码位于 <code>Illuminate/Foundation/Bootstrap/HandleExceptions.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdryme3mlvj20gw0e0q3w" alt></p>
<hr>
<h3 id="异常的渲染"><a href="#异常的渲染" class="headerlink" title="异常的渲染"></a>异常的渲染</h3><p><a href="https://github.com/laravel/framework/blob/7212b1e9620c36bf806e444f6931cf5f379c68ff/src/Illuminate/Foundation/Bootstrap/HandleExceptions.php#L95" target="_blank" rel="noopener"> 代码位于 <code>Illuminate/Foundation/Bootstrap/HandleExceptions.php</code></a></p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdryv04wm4j20kb0cdq3r" alt></p>
<hr>
<h2 id="两者的比较"><a href="#两者的比较" class="headerlink" title="两者的比较"></a>两者的比较</h2><ul>
<li>都能捕获到用户应用层面没能catch到的异常，并作相应的处理</li>
<li>laravel兼容php7，可以捕获 <code>fatal error</code> 并作处理</li>
<li>laravel中用户通过定义<code>Handler</code>渲染输出异常（TP可配置自定义错误页面）</li>
<li>ThinkPHP在所有异常抛出的时候都给客户端发送了一个404的响应头 令人费解</li>
</ul>
<hr>
<h2 id="应用层的异常处理"><a href="#应用层的异常处理" class="headerlink" title="应用层的异常处理"></a>应用层的异常处理</h2><blockquote>
<p>框架只是解决了基础的问题，要把异常系统做好，还需要在应用层面下功夫</p>
</blockquote>
<p>Laravel推介的方式：每一个模块或者库异常都建立自己的异常处理类</p>
<hr>
<h2 id="分享一种异常处理方案"><a href="#分享一种异常处理方案" class="headerlink" title="分享一种异常处理方案"></a>分享一种异常处理方案</h2><ul>
<li>按照模块来定义异常类</li>
<li>精细化异常CODE || IDE便可以定位异常，并找到注解</li>
<li>全局CODE定义 ，抛出异常时引用全局CODE 便于定位异常</li>
<li>捕获的时候使用case 进行CODE比对 </li>
</ul>
<hr>
<h2 id="基础父类"><a href="#基础父类" class="headerlink" title="基础父类"></a>基础父类</h2><blockquote>
<p>talk is cheep , show me the code !</p>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fds9wqhqjvj20rt0lm0uc" alt></p>
<hr>
<h2 id="自定义异常子类"><a href="#自定义异常子类" class="headerlink" title="自定义异常子类"></a>自定义异常子类</h2><blockquote>
<p>按照不同模块定义不同的子类</p>
</blockquote>
<h3 id="系统异常"><a href="#系统异常" class="headerlink" title="系统异常"></a>系统异常</h3><p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdsa8n2l67j20qj0ehabs" alt></p>
<hr>
<h2 id="抛出并捕获异常"><a href="#抛出并捕获异常" class="headerlink" title="抛出并捕获异常"></a>抛出并捕获异常</h2><p>抛出</p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdsabfjtcjj20sy04eq3f" alt></p>
<p>捕获</p>
<p><img src="http://ww1.sinaimg.cn/large/7101c223gy1fdsadms955j20m10dq75z" alt></p>
<hr>
<h2 id="在什么时候什么地方抛出异常"><a href="#在什么时候什么地方抛出异常" class="headerlink" title="在什么时候什么地方抛出异常"></a>在什么时候什么地方抛出异常</h2><ul>
<li>当然是Validate 、Model、Service、Api 这些地方</li>
<li>在控制器中捕获异常、并根据错误码结合请求客户端给予合适的响应</li>
<li>没有被抓住的异常，按照框架的要求，需要定义handler去处理，确保万无一失</li>
</ul>
<hr>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>除了调试需要尽量不要在流程里面使用 die或者exit 这种会直接导致异常失效</li>
</ul>
<hr>
<h1 id="感谢大家的参与！"><a href="#感谢大家的参与！" class="headerlink" title="感谢大家的参与！"></a>感谢大家的参与！</h1>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2015-08-12-laravel-encrypt/">laravel encrypt</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span></div>
    </header>

    <div class="post-content"><h2 id="加密方式"><a href="#加密方式" class="headerlink" title="加密方式"></a>加密方式</h2><p>默认的加密模式是 128位AES 使用 CBC模式加密，PKCS7进行pad.</p>
<p>block size 是16位。</p>
<p>使用base64_encode来进行输出。</p>
<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><pre><code>默认的key 在 config/app.php里面设置

Crypt::ecrypt()</code></pre><h2 id="相关介绍文章"><a href="#相关介绍文章" class="headerlink" title="相关介绍文章"></a>相关介绍文章</h2><p> <a href="http://laravel-recipes.com/categories/15" target="_blank" rel="noopener">http://laravel-recipes.com/categories/15</a></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/09/30/2015-07-08-laravel-compile-error/">laravel compile 的bug</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-09-30
        </span></div>
    </header>

    <div class="post-content"><h3 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h3><pre><code>&apos;Declaration of Illuminate\View\Engines\CompilerEngine::handleViewException() should be compatible</code></pre><h3 id="错误原因"><a href="#错误原因" class="headerlink" title="错误原因"></a>错误原因</h3><pre><code>原因是本地生成的compiler.php 被上传到其他环境的原因。</code></pre><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><pre><code>rm bootstrap/compile.php

或者

php artisan clear-compiled</code></pre><h3 id="最佳方案，修改composer-json文件"><a href="#最佳方案，修改composer-json文件" class="headerlink" title="最佳方案，修改composer.json文件"></a>最佳方案，修改composer.json文件</h3><pre><code>&quot;pre-install-cmd&quot; :[
    &quot;php artisan clear-compiled&quot;
],
&quot;pre-update-cmd&quot;: [
    &quot;php artisan clear-compiled&quot;
],</code></pre>
        </div></article>
      <nav class="pagination"><a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/ahonn" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2019<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">John Doe</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
